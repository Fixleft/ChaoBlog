import{j as e,r as n}from"./framer-TAp2EHm1.js";import{B as p}from"./button-4c2KjQxI.js";import{e as L,c as y,C as g,d as h,a as k,b as I}from"./index-ufr3Enzw.js";import{L as f,I as j}from"./label-Dg7hZxrq.js";import{c as _}from"./index-De41xqz2.js";import{u as A}from"./index-DNux_Z8B.js";import"./react-Csw2ODfV.js";import"./index-CxGmL32K.js";import"./index-DadMF53N.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],F=L("loader-circle",E),P=_("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function v({className:s,variant:a,...t}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:y(P({variant:a}),s),...t})}function N({className:s,...a}){return e.jsx("div",{"data-slot":"alert-description",className:y("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",s),...a})}function J(){const[s,a]=n.useState(""),[t,w]=n.useState(""),[c,d]=n.useState(!1),[m,i]=n.useState(""),[b,u]=n.useState(!1),x=A(),C="https://www.chaosama.asia",S=async r=>{r.preventDefault(),d(!0),i(""),u(!1);try{const l=await fetch(`${C}/api/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,password:t})}),o=await l.json();l.ok&&o.success?(u(!0),localStorage.setItem("token",o.token),console.log("登录成功:",o.message),x("/manage")):i(o.message||"登录失败")}catch(l){console.error("登录请求失败:",l),i("网络错误，请稍后重试")}finally{d(!1)}};return b?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(g,{className:"mx-auto max-w-sm",children:e.jsx(h,{className:"pt-6",children:e.jsx(v,{className:"border-green-200 bg-green-50",children:e.jsx(N,{className:"text-green-800",children:"登录成功！正在跳转..."})})})})}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs(g,{className:"mx-auto max-w-sm",children:[e.jsx(k,{className:"space-y-1",children:e.jsx(I,{className:"text-2xl font-bold text-center",children:"ChaoSAMA"})}),e.jsxs(h,{children:[e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"username",children:"username"}),e.jsx(j,{id:"username",type:"text",placeholder:"username",value:s,onChange:r=>a(r.target.value),required:!0,disabled:c})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"password",children:"password"}),e.jsx(j,{id:"password",type:"password",placeholder:"password",value:t,onChange:r=>w(r.target.value),required:!0,disabled:c})]}),m&&e.jsx(v,{className:"border-red-200 bg-red-50",children:e.jsx(N,{className:"text-red-800",children:m})}),e.jsx(p,{type:"submit",className:"w-full",disabled:c||!s||!t,children:c?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),"登录中..."]}):"登录"})]}),e.jsx(p,{className:"w-full mt-2",onClick:()=>x("/"),children:"返回"})]})]})})}export{J as default};
